<!DOCTYPE html>
<html>
  <head>
    <title>Invert Image Colors</title>
  </head>
  <body>
    <input type="file" id="imageInput" accept="image/png" />
    <div>
      <h3>Original Image:</h3>
      <img id="originalImage" />
      <h3>Inverted Image:</h3>
      <canvas id="canvas"></canvas>
    </div>
    <script src="invertImage.js"></script>
  </body>

  <script>
    document
      .getElementById("imageInput")
      .addEventListener("change", function (event) {
        const file = event.target.files[0];
        if (!file.type.match("image/png")) {
          alert("Please select a PNG image.");
          return;
        }

        const reader = new FileReader();
        reader.onload = function (fileEvent) {
          const arrayBuffer = fileEvent.target.result;
          const img = new Image();
          img.onload = function () {
            invertImageColors(img);
          };
          img.src = URL.createObjectURL(file);
          document.getElementById("originalImage").src = img.src;
        };
        reader.readAsArrayBuffer(file);
      });

    function invertImageColors(img) {
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      canvas.width = img.width;
      canvas.height = img.height;

      ctx.drawImage(img, 0, 0, img.width, img.height);
      const imageData = ctx.getImageData(0, 0, img.width, img.height);
      const data = imageData.data; // This is a Uint8ClampedArray
      console.log(data) ;
      // Invert colors
      for (let i = 0; i < data.length; i += 4) {
        data[i] = 255 - data[i]; // Red
        data[i + 1] = 255 - data[i + 1]; // Green
        data[i + 2] = 255 - data[i + 2]; // Blue
        // Alpha (data[i + 3]) remains unchanged
      }

      ctx.putImageData(imageData, 0, 0);
    }
  </script>
</html>
